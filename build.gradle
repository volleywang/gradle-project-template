/*
 * This build file was generated by the Gradle 'init' task.
 *
 * This generated file contains a commented-out sample Java project to get you started.
 * For more details take a look at the Java Quickstart chapter in the Gradle
 * user guide available at https://docs.gradle.org/3.5/userguide/tutorial_java_projects.html
 */
buildscript{
	repositories{ 
	   //依赖Maven仓库
		mavenCentral() 
	}
	
	dependencies {   
	   //使用1.5.4.RELEASE版本的Spring框架
		classpath('org.springframework.boot:spring-boot-gradle-plugin:1.5.4.RELEASE') 
	}
}

// 全局配置
apply plugin: 'eclipse'
apply from: './gradle/libraries.gradle'

// 产品构建版本号
version = '0.1'

// 项目全局配置
allprojects{
	// 全局依赖类库，建议使用Maven，方便搭建本地版本库做产品全局的依赖管理，和产品模块发布和模块依赖管理。
	repositories {
	    mavenLocal()
		mavenCentral()
		maven {
		    // 使用国内淘宝的Maven镜像
			url 'http://maven.aliyun.com/nexus/content/groups/public'  
		}
	}
}

// 所有子项目（组件component）的通用配置
subprojects {
}

/*
 *  子项目根据技术栈不同配置不同的依赖和构建环境
 */

// 领域实体组件，主要涉及数据持久化和业务基本服务能力构建
// Hibernate + Spring
project(':module-iam'){
	apply plugin: 'eclipse'
	apply plugin: 'java'

	// java编译版本号
	sourceCompatibility = 1.8
	// java运行版本号
	targetCompatibility = 1.8

	dependencies {
		// 通用编译依赖
		//compile('org.springframework.boot:spring-boot-starter-web:1.5.4.RELEASE')

		//通用运行依赖
		runtime( libraries.mysql_jdbc )

		// 测试编译依赖
		//testCompile('org.springframework.boot:spring-boot-starter-test:1.5.4.RELEASE')

		// 测试运行依赖
		//        testRuntime()
	}
}

// 边界服务组件，主要涉及模块或组建对外开放服务的能力构建
// REST + Spring
project(':module-service-rest-jersey'){
	apply plugin: 'eclipse-wtp'
	apply plugin: 'java'
	apply plugin: 'war'
	apply plugin: 'spring-boot'
	apply plugin: 'jetty'
    //apply from: 'https://raw.github.com/akhikhl/gretty/master/pluginScripts/gretty.plugin'
	
	// java编译版本号
	sourceCompatibility = 1.8
	// java运行版本号
	targetCompatibility = 1.8

	dependencies {
		// 通用编译依赖
		compile( libraries.spring_boot_starter_web ){ 
		    exclude module: "spring-boot-starter-tomcat" 
		}
		compile( libraries.spring_boot_starter_jetty )

		//通用运行依赖
		//        runtime()

		// 测试编译依赖
		testCompile(libraries.spring_boot_starter_test)
		testCompile(libraries.spring_test)
		

		// 测试运行依赖
		//        testRuntime()
	}
}

// 终端用户portal，遵循前后端分离的原则，只包含页面。
// vue + REST
project(':module-web-portal-vue'){
	apply plugin: 'eclipse-wtp'
	apply plugin: 'java'
	apply plugin: 'war'

	// java编译版本号
	sourceCompatibility = 1.8
	// java运行版本号
	targetCompatibility = 1.8
}
